<!DOCTYPE html>
<html>
<head>
  <title>Draw Your Picture</title>
  <style>
    #canvas {
      border: 1px solid black;
    }

    #colorGrid {
      display: flex;
      flex-wrap: wrap;
    }

    .colorSquare {
      width: 30px;
      height: 30px;
      margin: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Draw Your Picture</h1>
  <div id="colorGrid">
    <div class="colorSquare" style="background-color: #000000" onclick="selectColor('#000000')"></div>
    <div class="colorSquare" style="background-color: #ff0000" onclick="selectColor('#ff0000')"></div>
    <div class="colorSquare" style="background-color: #00ff00" onclick="selectColor('#00ff00')"></div>
    <div class="colorSquare" style="background-color: #0000ff" onclick="selectColor('#0000ff')"></div>
    <!-- Add more color squares as needed -->
  </div>
  <div>
    <button onclick="switchToEraser()">Eraser</button>
  </div>
  <canvas id="canvas" width="500" height="300"></canvas>
  <button onclick="clearCanvas()">Clear</button>
  <button onclick="processDrawing()">Process</button>

  <script>
    // JavaScript drawing logic
    let canvas = document.getElementById('canvas');
    let context = canvas.getContext('2d');
    let isDrawing = false;
    let currentColor = '#000000'; // Default color is black
    let eraserMode = false;

    // Function to get the mouse position relative to the canvas
    function getMousePos(canvas, event) {
      let rect = canvas.getBoundingClientRect();
      return {
        x: event.clientX - rect.left,
        y: event.clientY - rect.top
      };
    }

    // Event listeners to handle drawing
    canvas.addEventListener('mousedown', function (event) {
      isDrawing = true;
      let mousePos = getMousePos(canvas, event);
      context.beginPath();
      context.moveTo(mousePos.x, mousePos.y);
      context.strokeStyle = eraserMode ? 'white' : currentColor;
      context.lineWidth = eraserMode ? 80 : 30; // Adjust eraser size if needed
    });

    canvas.addEventListener('mousemove', function (event) {
      if (isDrawing) {
        let mousePos = getMousePos(canvas, event);
        context.lineTo(mousePos.x, mousePos.y);
        context.stroke();
      }
    });

    canvas.addEventListener('mouseup', function () {
      isDrawing = false;
    });

    // Function to clear the canvas
    function clearCanvas() {
      context.clearRect(0, 0, canvas.width, canvas.height);
    }

    // Function to process the drawing (you'll implement this later)
    function processDrawing() {
      // Get the image data from the canvas and send it to the backend
      let imageData = canvas.toDataURL();
      // Send imageData to the backend API for image comparison (Step 2)
    }

    // Function to switch to eraser mode
    function switchToEraser() {
      eraserMode = !eraserMode;
      if (eraserMode) {
        deselectColor();
      }
    }

    // Function to select a color from the grid
    function selectColor(color) {
      if (!eraserMode) {
        currentColor = color;
        context.strokeStyle = currentColor;
      }
    }

    // Function to deselect the color
    function deselectColor() {
      currentColor = '';
      context.strokeStyle = eraserMode ? 'white' : currentColor;
    }
  </script>
</body>
</html>
